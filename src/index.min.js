console.log("finance Start");const dom=function(t){return t.addClass=(e=>(t.classList.add(e),t)),t.removeClass=(e=>(t.classList.remove(e),t)),t.hasClass=(e=>t.classList.contains(e)),t.cssName=(e=>(t.className=e,t)),t.hide=(e=>(t.classList.add("elNoDisplay"),t)),t.toggleDisplay=(e=>(t.classList.toggle("elNoDisplay"),t)),t.show=(e=>(t.classList.remove("elNoDisplay"),t)),t.isHidden=(e=>t.classList.contains("elNoDisplay")),t.slideOut=(e=>(t.classList.add("elSlideOut"),t)),t.slideIn=(e=>(t.classList.remove("elSlideOut"),t)),t.ridKids=((e=0)=>{for(;t.children[e];)t.removeChild(t.lastChild);return t}),t.on=((e,n,a)=>(t.addEventListener(e,n,a),t)),t.onClick=((e,n)=>(t.addEventListener("click",e,n),t)),t.selfClick=(e=>(t.click(),t)),t.attachTo=(e=>(e.appendChild(t),t)),t.attach=(e=>(e&&t.appendChild(e),t)),t.attachAry=(e=>(e.length&&t.append(...e),t)),t.kids=(e=>[...t.parentElement.children]),t.kill=(e=>(t.remove(),t)),t.forebear=(e=>[...Array(++e)].fill(t).reduce(t=>t?t.parentElement:null)),t.sibling=(e=>t.kids()[e+t.kids().findIndex(e=>e===t)]||null),t.setAttr=((e,n)=>(t.setAttribute(e,n),t)),t.html=(e=>(t.innerHTML=e,t)),t.txt=(e=>(t.textContent=e,t)),t.clone=(e=>dom(t.cloneNode(e))),t.kidsByClass=(e=>[...t.getElementsByClassName(e)]),t.addTxt=(e=>t.attach(document.createTextNode(e))),t};dom.add=(t=>dom(document.createElement(t))),dom.adDiv=((t="",e="")=>dom.add("div").html(e).cssName(t)),[...document.querySelectorAll("*")].forEach(dom),Array.prototype.getDuplicates=function(){for(var t={},e=0;e<this.length;e++)t.hasOwnProperty(this[e])?t[this[e]].push(e):this.lastIndexOf(this[e])!==e&&(t[this[e]]=[e]);return t},Array.prototype.getUniques=function(){for(var t=[],e=0;e<this.length;e++)this.lastIndexOf(this[e])===e&&t.push(e);return t},Array.prototype.getSum=function(t){return this.reduce((e,n)=>e+(e=>t.reduce((t,n)=>t+e[n],0))(n),0)},Date.prototype.toUKstringDateTime=function(){return this.toLocaleString("en-GB",{timeZone:"Europe/London"})},Date.prototype.toUKstringDate=function(){return this.toLocaleDateString("en-GB",{timeZone:"Europe/London"})};const gbp="£",eur="€",getFormatString=(t,e)=>e?t?t>0?e+t.toFixed(2):"- "+e+(-t).toFixed(2):"-":t||"-",getNumber=t=>"number"==typeof t&&isFinite(t)?t:null;function getMonthsAry(t){const e=[];for(;t<new Date;)e.push(new Date(t)),t.setMonth(t.getMonth()+1);return e}function getDateFromMMDDYYYY(t){var e=t.split("/");return new Date(+e[2],e[1]-1,+e[0])}function getKeyMaterial(t){return window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveBits","deriveKey"])}async function deriveKey(t,e){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:1e5,hash:"SHA-256"},await getKeyMaterial(t),{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function getDecryptedString(t,e){const n=(new TextEncoder).encode(e),a=[...new Uint8Array(t)],r=new Uint8Array(a.splice(0,16)),i=new Uint8Array(a.splice(0,12)),s=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},await deriveKey(n,r),new Uint8Array(a));return(new TextDecoder).decode(s)}async function getServerFileContents(){return(await fetch("finance.db")).arrayBuffer()}async function readFinanceDb(t,e){const n=await e(t),a=await getDecryptedString(n,t);return JSON.parse(a)}const startApp=async t=>{t.preventDefault();const e=t.target[0].value,n=window.initLocal,a=n?getLocalFileContents:getServerFileContents;let r;try{r=await readFinanceDb(e,a)}catch(t){return console.log(t),alert("Access Error")}n&&(r.code=code),dom.add("script").addTxt(r.code).attachTo(document.head);const i=new FundsObject(r);paintRemontPieChart=paintRemontPieChart(i),swichFund=swichFund(i),paintDomElements(i,"remont"),window.addEventListener("resize",setDomElsSize),t.target.forebear(2).kill(),n&&initLocal(i,e)};dom.adDiv("passSect").attach(dom.adDiv("passWrp").attach(dom.add("form").attachAry([dom.add("input").setAttr("type","password").setAttr("placeholder","... Type Password ..."),dom.add("input").html("Submit").setAttr("type","submit")]).on("submit",startApp))).attachTo(document.body);